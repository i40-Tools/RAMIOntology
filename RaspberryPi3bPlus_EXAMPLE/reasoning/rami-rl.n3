@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix rami: <https://w3id.org/i40/rami#> .
@prefix iaisex: <https://iais.fraunhofer.de/en/aas/examples/> .
@prefix aas: <http://www.admin-shell.io/aas/1/0/> .
@prefix string: <http://www.w3.org/2000/10/swap/string#>.
@prefix math: <http://www.w3.org/2000/10/swap/math#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix : <http://example.org/> .

# NOTE rami:hasSubmodel inverse property of rami:parent
{ 
	?a rami:hasSubmodel ?b . 
} => {
	?b rami:parent ?a . 
} .

# TODO implement
{
    ?a rami:idShort ?id_short .
    ?b rami:idShort ?id_short2 .
   # ?id_short string:equalIgnoringCase ?id_short2 .
    ?id_short log:equalTo ?id_short2 .
} => { 
	?a owl:sameAs ?b . 
} .


# NOTE define asset as powered devices if it is and define elements of a computer:
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "ghz" .
} => { 
    ?asset :category :powered_device .
    ?asset :has :processor .
    ?asset :processor ?a .
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "ampere" .
} => { 
    ?asset :category :powered_device . 
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "voltage" .
} => { 
    ?asset :category :powered_device . 
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "disk" .
} => { 
    ?asset :category :powered_device . 
    ?asset :has :disk .
    ?asset :disk ?a .
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "drive" .
} => { 
    ?asset :category :powered_device . 
    ?asset :has :disk .
    ?asset :disk ?a .
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "storage" .
} => { 
    ?asset :category :powered_device . 
    ?asset :has :disk .
    ?asset :disk ?a .
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "memory" .
} => { 
    ?asset :category :powered_device .
    # memory as synonym for ram
    ?asset :has :ram . 
    ?asset :ram ?a .
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:containsIgnoringCase "ram" .
} => { 
    ?asset :category :powered_device .
    ?asset :has :ram .
    ?asset :ram ?a .
} .
######### Old vesion does not refer to asset either to SubmodelElement
#{ ?a rdfs:comment ?b . ?b string:contains "ghz" . } => { ?a :category :powered_device . } .
#{ ?a rdfs:comment ?b . ?b string:contains "ampere" . } => { ?a :category :powered_device . } .
#{ ?a rdfs:comment ?b . ?b string:contains "voltage" . } => { ?a :category :powered_device . } .
#{ ?a rdfs:comment ?b . ?b string:contains "memory" . } => { ?a :category :powered_device . } .



# NOTE light_powered_devices are devices with a voltage not greater than 5V
#{
#    ?asset :category :powered_device .
#    ?asset rami:hasSubmodel ?bn_td .
#    ?bn_td rami:hasSubmodelElement ?a .
#    ?a rdfs:label "power-in"^^xsd:string .
#    #TODO: There are a lot of predicates and not every predicate is a INT. This causes errors
#    ?a ?predicate ?b .
#    ?b math:lessThan "5"^^ . # unit needs to be specified in conceptDescription of device
#} => { 
#    ?asset :category :light_powered_device . 
#} .



# define specifications of powered devices:
{
    ?asset :category :powered_device .
} => {
    ?asset rdfs:subClassOf :electricity-consumer .
} .
# if the power-in of a device less than 5V it is a light-powered-device

# NOTE rules/notes for light-powered-devices
{
    ?asset :category :light_powered_device .
    ?asset ?predicate ?value_of_td_s .
    ?value_of_td_s string:equalIgnoringCase "rj45"^^xsd:string .
} => { 
    ?asset skos:note "May be modified without certification."@en . 
    ?asset skos:note "Can be charged via USB"@en .
	?asset skos:note "Could be supplied by PoE if possible"@en . 
} .

# NOTE specify all network-devices as network-device
{
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?comment .
    ?comment string:contains "network" .
} => {
    ?asset :category :network-device .
} .

# NOTE rules and notes for network-devices
{
    ?asset :category :network-device .
} => { 
	?asset skos:note "Needs IP-address and MAC."@en . 
    # all network-devices are powered-devices:
    ?asset :category :powered_device .
} .

# NOTE detect if device hsa usb-ports
{
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:label ?label_value .
    ?label_value string:containsIgnoringCase "usb" .
} => {
    ?asset :has :usb-ports .
} .

# NOTE rules/notes for usb-ports
{
    ?asset :has :usb-ports .
    # FIXME
    ?asset log:notEqualTo ?light_powered_device_var .
    ?light_powered_device_var :category :light_powered_device .
} => {
    ?asset 
        :is :usb-power-supplier ;
        skos:note "Is a possible power-supplier for devices that can be charged via USB"@en .
} .

# NOTE detect if asset has a processor
{
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?sme .
    ?sme rdfs:label ?label_of_sme .
    ?label_of_sme string:containsIgnoringCase "processor" .
} => {
    ?asset 
        :has :processor ;
        skos:note "The asset has a processor"@en .
} .

# NOTE rules/notes for processors
{
    ?asset :has :processor .
    ?asset rami:hasSubmodel ?bn_sm_td .
    ?bn_sm_td rami:hasSubmodelElement ?sme .
    ?sme a rami:SubmodelElement .
    ?sme rdfs:label ?bn_td_sme_label .
    ?bn_td_sme_label string:containsIgnoringCase "architecture" .
    #?sme ?predicate_reference_to_value ?architecture_value .
    ?sme ?predicate_reference_to_value ?architecture_value .
    ?predicate_reference_to_value string:containsIgnoringCase "architecture"^^xsd:string .
} => {
    ?asset :has-x-y-bit-architecture ?architecture_value .
    # TODO: Is there string concatenation in RDF ?
    #?asset skos:note "The Operating System should be designed for a "?architecture_value" architecture" .
} .

# NOTE define which architecture the processor of the asset has
{
    ?asset :has-x-y-bit-architecture ?value .
    ?value string:containsIgnoringCase "32" .
} => {
    ?asset skos:note "The Operating System should be designed for a 32-Bit architecture"@en .
    ?asset :has :thrity-two-bit_processor_architecture .
} .
{
    ?asset :has-x-y-bit-architecture ?value .
    ?value string:containsIgnoringCase "64" .
} => {
    ?asset 
        skos:note "The Operating System should be designed for a 64-Bit architecture"@en ;
        :has :sixty-four-bit_processor_architecture .
} .

# NOTE detect if there is a specification of details in something that is calles "sheet":
{
    ?asset rami:hasSubmodel ?bn_dcm .
    ?bn_dcm rami:hasSubmodel ?sm .
    ?sm rami:hasSubmodelElementCollection ?smec .
    ?smce rami:idShort ?identifier_of__documentation_appendix .
    ?identifier_of__documentation_appendix string:containsIgnoringCase "sheet" .
} => {
    ?asset 
        :has :product_sheet ;
        skos:note "The specification concerning some details of this asset is in one appendix."@en .
} .

# NOTE detect if the asset is a computer
{
    ?asset :has :processor .
    ?asset :has :ram .
    ?asset :has :disk .
} => {
    ?asset 
        :category :computer ;
        skos:note "This asset is a computer"@en .
} .

# NOTE detect if it is possible to run a MySQL-database on a computer
{
    # TODO: Implement check if the computer has at least 2GB of RAM and 1.2GB of space
    ?asset :category :computer .
} => {
    ?asset skos:note "It is possible for the asset to host the MySQL-DBMS"@en .
} .