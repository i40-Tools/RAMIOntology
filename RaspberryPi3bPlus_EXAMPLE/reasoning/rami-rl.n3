@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix rami: <https://w3id.org/i40/rami#> .
@prefix iaisex: <https://iais.fraunhofer.de/en/aas/examples/> .
@prefix aas: <http://www.admin-shell.io/aas/1/0/> .
@prefix string: <http://www.w3.org/2000/10/swap/string#>.
@prefix math: <http://www.w3.org/2000/10/swap/math#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix : <http://example.org/> .


# NOTE rami:hasSubmodel inverse property of rami:parent
{ 
	?a rami:hasSubmodel ?b . 
} => {
	?b rami:parent ?a . 
} .


# TODO implement
{
    ?a rami:idShort ?id_short .
    ?b rami:idShort ?id_short2 .
   # ?id_short string:equalIgnoringCase ?id_short2 .
    ?id_short log:equalTo ?id_short2 .
} => { 
	?a owl:sameAs ?b . 
} .


# NOTE define asset as powered devices if it is:
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:contains "GHz" .
} => { 
    ?asset :category :powered_device . 
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:contains "ghz" .
} => { 
    ?asset :category :powered_device . 
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:contains "ampere" .
} => { 
    ?asset :category :powered_device . 
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:contains "voltage" .
} => { 
    ?asset :category :powered_device . 
} .
{ 
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?b .
    ?b string:contains "memory" .
} => { 
    ?asset :category :powered_device . 
} .
######### Old vesion does not refer to asset either to SubmodelElement
#{ ?a rdfs:comment ?b . ?b string:contains "ghz" . } => { ?a :category :powered_device . } .
#{ ?a rdfs:comment ?b . ?b string:contains "ampere" . } => { ?a :category :powered_device . } .
#{ ?a rdfs:comment ?b . ?b string:contains "voltage" . } => { ?a :category :powered_device . } .
#{ ?a rdfs:comment ?b . ?b string:contains "memory" . } => { ?a :category :powered_device . } .



# NOTE light_powered_devices are devices with a voltage not greater than 5V
#{
#    ?asset :category :powered_device .
#    ?asset rami:hasSubmodel ?bn_td .
#    ?bn_td rami:hasSubmodelElement ?a .
#    ?a rdfs:label "power-in"^^xsd:string .
#    #TODO: There are a lot of predicates and not every predicate is a INT. This causes errors
#    ?a ?predicate ?b .
#    ?b math:lessThan "5"^^ . # unit needs to be specified in conceptDescription of device
#} => { 
#    ?asset :category :light_powered_device . 
#} .



# define specifications of powered devices:
{
    ?asset :category :powered_device .
} => {
    ?asset rdfs:subClassOf :requires_current .
} .
# if the power-in of a device less than 5V it is a light-powered-device

# NOTE rules/notes for light-powered-devices
{
    ?asset :category :light_powered_device .
    ?asset ?predicate ?value_of_td_s .
    ?value_of_td_s string:equalIgnoringCase "rj45"^^xsd:string .
} => { 
    ?asset skos:note "May be modified without certification."@en . 
    ?asset skos:note "Can be charged via USB"@en .
	?asset skos:note "Could be supplied by PoE if possible"@en . 
} .

# NOTE specify all network-devices as network-device
{
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:comment ?comment .
    ?comment string:contains "network" .
} => {
    ?asset :category :network-device .
} .

# NOTE rules and notes for network-devices
{
    ?asset :category :network-device .
} => { 
	?asset skos:note "Needs IP-address and MAC."@en . 
    # all network-devices are powered-devices:
    ?asset :category :powered_device .
} .

# NOTE detect if device hsa usb-ports
{
    ?asset rami:hasSubmodel ?bn_td .
    ?bn_td rami:hasSubmodelElement ?a .
    ?a rdfs:label ?label_value .
    ?label_value string:contains "uSB" .
} => {
    ?asset :has :usb-ports .
} .

# NOTE rules/notes for usb-ports
{
    ?asset :has :usb-ports .
    # FIXME
    ?asset log:notEqualTo ?light_powered_device_var .
    ?light_powered_device_var :category :light_powered_device .
} => {
    ?asset :is :usb-power-supplier .
    ?asset skos:note "Is a possible power-supplier for devices that can be charged via USB"@en .
} .